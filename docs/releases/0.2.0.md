# mdbase-spec v0.2.0 — API-Style Changelog

**Date:** 2026-02-03

## New (Spec Surface)

- **Operation:** `backfill` (Level 6) — apply defaults/generated values to missing fields.
  - Applies only to **missing** fields (explicit `null` is considered present).
  - Supports `dry_run` and batch-style `batch_result` output.
- **Operation:** `migrate` (Level 6) — execute migration manifests.
  - Runs steps in order, executes `backfill` steps, and reports per-step status.
  - `dry_run` forces backfill steps to run in dry-run mode.
- **Settings:** `settings.migrations_folder`.
  - Default: `<types_folder>/_migrations`.
- **Type Field:** `version` (informational, migration tooling).
  - Optional integer; does not affect validation unless tooling opts in.
- **Error Codes:** `invalid_migration`, `migration_failed`, `invalid_request`.
  - `invalid_request` covers missing `type`/`where` for `backfill`, or missing `id`/`path` for `migrate`.
- **Artifacts:** migration manifest format (`_types/_migrations/*.md` by default).
  - Manifest frontmatter requires `steps` array with `id` + `op` per step.

## Behavior Changes

- **Path derivation:** `filename_pattern` renamed to `path_pattern` (alias preserved).
- **Unresolvable path vars:** `path_pattern` variables that resolve to null/empty now fail with `path_required`.
- **Defaults:** `settings.write_defaults` controls persistence of default-only values.
- **Generated fields:** new strategies `random`, `sequence`, `{from: file.*}`.
- **Display name:** `display_name_key` + `file.display_name`.
- **Init:** formalized `init` operation with required meta type.
- **Match rules:** explicit-type create match-rule enforcement scoped to Level 2+.
- **Datetime portability:** `settings.timezone` added; applies to `now()`/`today()` and naive comparisons.
- **Expressions:** `reduce()` requires explicit `init`; list methods `value/index/acc` shadow frontmatter fields.
- **Links:** `ambiguous_link` is an error on ID ambiguity, warning after tiebreakers.
 - **Non-scalar ordering:** `order_by` on lists/objects now specifies deterministic ordering rules.

## Removed / Deprecated

- `filename_pattern` deprecated (use `path_pattern`).

## Conformance & Tests

- New Level 6 tests for migration/backfill.
- Guardrail: tests must not reference higher-level sections than their declared level.
- Expanded L1–L6 coverage for match rules, path-based matching, type functions, query namespaces, and link traversal edge cases.

## Non-API / Packaging

- License changed to MIT.
- Website updated: removed “Draft” label.
